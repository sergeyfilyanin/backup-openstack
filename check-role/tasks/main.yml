#  - name: Start T01 Administration - Cloud Service Tests
#    ansible.builtin.shell: npx playwright test T01.spec.ts --reporter allure-playwright
#    args:
#      chdir: /opt/openstack-testing/tests
#    register: results
#  - debug:
#      var: results.stdout_lines
      
  - name: Start T03 Administration - Compute / Storage Tests
    ansible.builtin.shell: npx playwright test ./tests/T03.spec.ts --reporter allure-playwright
    args:
      chdir: /opt/openstack-testing
    register: results
  - debug:
      var: results.stdout_lines

  - name: Start T06 Openstack Nodes Functionality Tests
    ansible.builtin.shell: npx playwright test ./tests/T06.spec.ts --reporter allure-playwright
    args:
      chdir: /opt/openstack-testing
    register: results
  - debug:
      var: results.stdout_lines
      
  - name: Start T07 RHOSP Version Tests
    ansible.builtin.shell: npx playwright test ./tests/T07.spec.ts --reporter allure-playwright
    args:
      chdir: /opt/openstack-testing
    register: results
  - debug:
      var: results.stdout_lines
      
#  - name: Start T04 Infrastructure-Virtual Resources Tests
#    ansible.builtin.shell: npx playwright test ./tests/T04.spec.ts --reporter allure-playwright
#    args:
#      chdir: /opt/openstack-testing
#    register: results
#  - debug:
#      var: results.stdout_lines

  - name: Allure generate results
    args:
      chdir: /opt/openstack-testing
    shell: |
      PATH=/opt/allure-commandline/allure-2.21.0/bin:$PATH
      allure generate allure-results --clean
    register: results
  - debug:
      var: results.stdout_lines
      
  - name: Allure generate report
    args:
      chdir: /opt/openstack-testing
    shell: |
      PATH=/opt/allure-commandline/allure-2.21.0/bin:$PATH
      node ./node_modules/allure-single-html-file-js/combine.js ./allure-report

  - name: Allure open allure-report
    args:
      chdir: /opt/openstack-testing
    shell: |
      PATH=/opt/allure-commandline/allure-2.21.0/bin:$PATH
      nohup allure serve -p 32300 &
